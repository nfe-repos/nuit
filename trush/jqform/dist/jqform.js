define("#jqform/0.1.0/jqform",["#jquery/0.1.0/jquery"],function(require,exports,module){function clickHandler(e){var t=this.form;t.clk=this;if(this.type=="image")if(e.offsetX!=undefined)t.clk_x=e.offsetX,t.clk_y=e.offsetY;else if(typeof $.fn.offset=="function"){var n=$(this).offset();t.clk_x=e.pageX-n.left,t.clk_y=e.pageY-n.top}else t.clk_x=e.pageX-this.offsetLeft,t.clk_y=e.pageY-this.offsetTop;setTimeout(function(){t.clk=t.clk_x=t.clk_y=null},10)}function submitHandler(){var e=this.formPluginId,t=$.fn.ajaxForm.optionHash[e];return $(this).ajaxSubmit(t),!1}var $=require("#jquery/0.1.0/jquery");return $.fn.ajaxSubmit=function(options){function fileUpload(){function cb(){if(cbInvoked++)return;io.detachEvent?io.detachEvent("onload",cb):io.removeEventListener("load",cb,!1);var ok=!0;try{if(timedOut)throw"timeout";var data,doc;doc=io.contentWindow?io.contentWindow.document:io.contentDocument?io.contentDocument:io.document,xhr.responseText=doc.body?doc.body.innerHTML:null,xhr.responseXML=doc.XMLDocument?doc.XMLDocument:doc;if(opts.dataType=="json"||opts.dataType=="script"){var ta=doc.getElementsByTagName("textarea")[0];data=ta?ta.value:xhr.responseText,opts.dataType=="json"?eval("data = "+data):$.globalEval(data)}else opts.dataType=="xml"?(data=xhr.responseXML,!data&&xhr.responseText!=null&&(data=toXml(xhr.responseText))):data=xhr.responseText}catch(e){ok=!1,$.handleError(opts,xhr,"error",e)}ok&&(opts.success(data,"success"),g&&$.event.trigger("ajaxSuccess",[xhr,opts])),g&&$.event.trigger("ajaxComplete",[xhr,opts]),g&&!--$.active&&$.event.trigger("ajaxStop"),opts.complete&&opts.complete(xhr,ok?"success":"error"),setTimeout(function(){$io.remove(),xhr.responseXML=null},100)}function toXml(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&t.documentElement.tagName!="parsererror"?t:null}var form=$form[0],opts=$.extend({},$.ajaxSettings,options),id="jqFormIO"+$.fn.ajaxSubmit.counter++,$io=$('<iframe id="'+id+'" name="'+id+'" />'),io=$io[0],op8=$.browser.opera&&window.opera.version()<9;if($.browser.msie||op8)io.src='javascript:false;document.write("");';$io.css({position:"absolute",top:"-1000px",left:"-1000px"});var xhr={responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){}},g=opts.global;g&&!($.active++)&&$.event.trigger("ajaxStart"),g&&$.event.trigger("ajaxSend",[xhr,opts]);var cbInvoked=0,timedOut=0;setTimeout(function(){$io.appendTo("body"),io.attachEvent?io.attachEvent("onload",cb):io.addEventListener("load",cb,!1);var e=form.encoding?"encoding":"enctype",t=$form.attr("target");$form.attr({target:id,method:"POST",encAttr:"multipart/form-data",action:opts.url}),opts.timeout&&setTimeout(function(){timedOut=!0,cb()},opts.timeout),form.submit(),$form.attr("target",t)},10)}typeof options=="function"&&(options={success:options}),options=$.extend({url:this.attr("action")||window.location,type:this.attr("method")||"GET"},options||{});var a=this.formToArray(options.semantic);if(options.beforeSubmit&&options.beforeSubmit(a,this,options)===!1)return this;var veto={};$.event.trigger("form.submit.validate",[a,this,options,veto]);if(veto.veto)return this;var q=$.param(a);options.type.toUpperCase()=="GET"?(options.url+=(options.url.indexOf("?")>=0?"&":"?")+q,options.data=null):options.data=q;var $form=this,callbacks=[];options.resetForm&&callbacks.push(function(){$form.resetForm()}),options.clearForm&&callbacks.push(function(){$form.clearForm()});if(!options.dataType&&options.target){var oldSuccess=options.success;callbacks.push(function(e){$(options.target).attr("innerHTML",e).evalScripts().each(oldSuccess,arguments)})}else options.success&&callbacks.push(options.success);options.success=function(e,t){for(var n=0,r=callbacks.length;n<r;n++)callbacks[n](e,t,$form)};var files=$("input:file",this).fieldValue(),found=!1;for(var j=0;j<files.length;j++)files[j]&&(found=!0);return options.iframe||found?fileUpload():$.ajax(options),$.event.trigger("form.submit.notify",[this,options]),this},$.fn.ajaxSubmit.counter=0,$.fn.ajaxForm=function(e){return this.ajaxFormUnbind().submit(submitHandler).each(function(){this.formPluginId=$.fn.ajaxForm.counter++,$.fn.ajaxForm.optionHash[this.formPluginId]=e,$(":submit,input:image",this).click(clickHandler)})},$.fn.ajaxForm.counter=1,$.fn.ajaxForm.optionHash={},$.fn.ajaxFormUnbind=function(){return this.unbind("submit",submitHandler),this.each(function(){$(":submit,input:image",this).unbind("click",clickHandler)})},$.fn.formToArray=function(e){var t=[];if(this.length==0)return t;var n=this[0],r=e?n.getElementsByTagName("*"):n.elements;if(!r)return t;for(var i=0,s=r.length;i<s;i++){var o=r[i],u=o.name;if(!u)continue;if(e&&n.clk&&o.type=="image"){!o.disabled&&n.clk==o&&t.push({name:u+".x",value:n.clk_x},{name:u+".y",value:n.clk_y});continue}var a=$.fieldValue(o,!0);if(a&&a.constructor==Array)for(var f=0,l=a.length;f<l;f++)t.push({name:u,value:a[f]});else a!==null&&typeof a!="undefined"&&t.push({name:u,value:a})}if(!e&&n.clk){var c=n.getElementsByTagName("input");for(var i=0,s=c.length;i<s;i++){var h=c[i],u=h.name;u&&!h.disabled&&h.type=="image"&&n.clk==h&&t.push({name:u+".x",value:n.clk_x},{name:u+".y",value:n.clk_y})}}return t},$.fn.formSerialize=function(e){return $.param(this.formToArray(e))},$.fn.fieldSerialize=function(e){var t=[];return this.each(function(){var n=this.name;if(!n)return;var r=$.fieldValue(this,e);if(r&&r.constructor==Array)for(var i=0,s=r.length;i<s;i++)t.push({name:n,value:r[i]});else r!==null&&typeof r!="undefined"&&t.push({name:this.name,value:r})}),$.param(t)},$.fn.fieldValue=function(e){for(var t=[],n=0,r=this.length;n<r;n++){var i=this[n],s=$.fieldValue(i,e);if(s===null||typeof s=="undefined"||s.constructor==Array&&!s.length)continue;s.constructor==Array?$.merge(t,s):t.push(s)}return t},$.fieldValue=function(e,t){var n=e.name,r=e.type,i=e.tagName.toLowerCase();typeof t=="undefined"&&(t=!0);if(t&&(!n||e.disabled||r=="reset"||r=="button"||(r=="checkbox"||r=="radio")&&!e.checked||(r=="submit"||r=="image")&&e.form&&e.form.clk!=e||i=="select"&&e.selectedIndex==-1))return null;if(i=="select"){var s=e.selectedIndex;if(s<0)return null;var o=[],u=e.options,a=r=="select-one",f=a?s+1:u.length;for(var l=a?s:0;l<f;l++){var c=u[l];if(c.selected){var h=$.browser.msie&&!c.attributes.value.specified?c.text:c.value;if(a)return h;o.push(h)}}return o}return e.value},$.fn.clearForm=function(){return this.each(function(){$("input,select,textarea",this).clearFields()})},$.fn.clearFields=$.fn.clearInputs=function(){return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();e=="text"||e=="password"||t=="textarea"?this.value="":e=="checkbox"||e=="radio"?this.checked=!1:t=="select"&&(this.selectedIndex=-1)})},$.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})},jQuery});